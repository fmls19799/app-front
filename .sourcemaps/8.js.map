{"version":3,"sources":["../../src/pages/items/items.module.ts","../../src/pages/items/items.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAyC;AACO;AACZ;AAC0C;AACxB;AAYtD;IAAA;IAA8B,CAAC;IAAlB,eAAe;QAV3B,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,yDAAS;aACV;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,yDAAS,CAAC;gBACnC,4EAAe,CAAC,QAAQ,EAAE;gBAC1B,6FAAsB;aACvB;SACF,CAAC;OACW,eAAe,CAAG;IAAD,sBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBqD;AACU;AACpB;AAEhB;AACP;AACC;AACQ;AAWzD;IAeE,mBAAmB,OAAsB,EAChC,SAAoB,EACnB,gBAAkC,EAClC,SAA0B,EAC1B,SAA2B,EAC3B,SAA0B;QALjB,YAAO,GAAP,OAAO,CAAe;QAChC,cAAS,GAAT,SAAS,CAAW;QACnB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,cAAS,GAAT,SAAS,CAAiB;QAC1B,cAAS,GAAT,SAAS,CAAkB;QAC3B,cAAS,GAAT,SAAS,CAAiB;QAlBpC,mBAAc,GAAoB,EAAE,CAAC;QACrC,eAAU,GAAW,YAAY,CAAC;QAClC,sBAAiB,GAAY,KAAK,CAAC;QACnC,0BAAqB,GAA2B,EAAE,CAAC;QACnD,qBAAgB,GAAW,mBAAmB,CAAC;QAK/C,wCAAwC;QACxC,kBAAa,GAAG,IAAI,kDAAY,EAAE,CAAC;IASjC,CAAC;kBArBQ,SAAS;IAuBlB,4BAAQ,GAAR;QACE,0GAA0G;QAC1G,oCAAoC;QACpC,KAAK;QACL,wCAAwC;QAGxC,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAED,kCAAc,GAAd;QAAA,iBAUC;QATC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,CAAC,SAAS,CAAC,UAAC,QAAwB;YAC3E,KAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;QAEjC,CAAC,EACD,UAAC,KAAK;YACJ,2BAA2B;YAC3B,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAErB,CAAC,CAAC;IACJ,CAAC;IAID,mCAAe,GAAf;QACE,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,UAAC,OAAwB;YAC1D,OAAO,CAAC,QAAQ,GAAG,KAAK,CAAC;QAC3B,CAAC,CAAC;QACF,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC;QAChC,IAAI,CAAC,gBAAgB,GAAG,mBAAmB,CAAC;QAC5C,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;IAED,4BAAQ,GAAR;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YACb,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACtB,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC;QACnB,CAAC;IACH,CAAC;IAED,oCAAgB,GAAhB;QACE,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,QAAQ,EAAE,CAAC;IAClB,CAAC;IAED,qCAAiB,GAAjB;QAEE,IAAI,CAAC,iBAAiB,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC;QACjD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC;YAC5B,IAAI,CAAC,eAAe,EAAE,CAAC;QACzB,CAAC;IAEH,CAAC;IAED,kCAAc,GAAd;QACE,EAAE,EAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,KAAK,CAAC,CAAC,EAAC;YAC1C,IAAI,CAAC,UAAU,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;QACzD,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YACjD,IAAI,CAAC,UAAU,CAAC,CAAC,gBAAgB,EAAE,cAAc,EAAE,aAAa,EAAE,eAAe,CAAC,EAAE,IAAI,CAAC,CAAC;QAC5F,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,GAAG,CAAC,CAAC,EAAC;YAEhD,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,EAAE,cAAc,EAAE,aAAa,EAAE,eAAe,CAAC,EAAE,IAAI,CAAC,CAAC;QAC7F,CAAC;IACH,CAAC;IAED,8BAAU,GAAV,UAAW,kBAA0C,EAAE,SAAkB,EAAE,2BAAqC;QAAhH,iBAQC;QAPC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,SAAS,CAAC,UAAC,IAAI;YACpD,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;gBACd,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YACvB,CAAC;YAAC,IAAI,EAAC;gBACL,KAAI,CAAC,SAAS,CAAC,IAAI,EAAE,2BAA2B,CAAC,CAAC;YACpD,CAAC;QACH,CAAC,CAAC;IACJ,CAAC;IAED,6BAAS,GAAT,UAAU,IAAI;QAAd,iBA8BC;QA7BC,IAAI,UAAU,CAAC;QACf,EAAE,EAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,KAAK,CAAC,CAAC,EAAC;YAC1C,UAAU,GAAG,IAAI,CAAC,4BAA4B;QAChD,CAAC;QACD,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YACjD,UAAU,GAAG,IAAI,CAAC,cAAc;QAClC,CAAC;QAAC,IAAI,EAAC;YACL,UAAU,GAAG,IAAI,CAAC,eAAe;QACnC,CAAC;QACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,KAAK,EAAE,UAAU;YACjB,OAAO,EAAE,IAAI,CAAC,YAAY;YAC1B,OAAO,EAAE;gBACP;oBACE,IAAI,EAAE,IAAI,CAAC,WAAW;oBACtB,OAAO,EAAE;wBACP,KAAI,CAAC,kBAAkB,EAAE,CAAC;oBAC5B,CAAC;iBACF;gBACD;oBACE,IAAI,EAAE,IAAI,CAAC,aAAa;oBACxB,IAAI,EAAE,QAAQ;oBACd,OAAO,EAAE;wBACP,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;oBAExB,CAAC;iBACF;aACF;SACF,CAAC,CAAC,OAAO,EAAE,CAAC;IACf,CAAC;IAED,6BAAS,GAAT,UAAU,IAAY,EAAE,2BAAqC;QAC3D,IAAI,aAAa,CAAC;QAClB,EAAE,CAAC,CAAC,2BAA2B,CAAC,CAAC,CAAC;YAChC,aAAa,GAAM,IAAI,CAAC,qBAAqB,CAAC,MAAM,SAAI,IAAM;QAChE,CAAC;QAAC,IAAI,EAAC;YACL,aAAa,GAAG,IAAI,CAAC;QACvB,CAAC;QACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,OAAO,EAAE,aAAa;YACtB,QAAQ,EAAE,IAAI;YACd,QAAQ,EAAE,KAAK;SAChB,CAAC,CAAC,OAAO,EAAE,CAAC;IACf,CAAC;IAED,6CAAyB,GAAzB,UAA0B,OAAwB;QAChD,OAAO,CAAC,QAAQ,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC;QAErC,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1E,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC3C,CAAC;QAAC,IAAI,EAAC;YACL,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,UAAC,IAAqB;gBACnF,MAAM,CAAC,IAAI,KAAK,OAAO,CAAC;YAC1B,CAAC,CAAC;QACJ,CAAC;QACD,oOAAoO;QACpO,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAED,8BAAU,GAAV;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YAC5C,IAAI,CAAC,gBAAgB,GAAG,mBAAmB,CAAC;QAC9C,CAAC;QAAC,IAAI,EAAC;YACL,IAAI,CAAC,gBAAgB,GAAG,WAAW,CAAC;QACtC,CAAC;IACH,CAAC;IAED,+BAAW,GAAX,UAAY,OAAgB;QAC1B,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,EAAE,OAAO,CAAC,CAAC;IAClD,CAAC;IAED,yDAAyD;IACzD,2CAA2C;IAE3C,sCAAkB,GAAlB;QAAA,iBA4BG;QA3BD,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,UAAC,OAAgB;YAClD,IAAI,CAAC,IAAI,CAAI,WAAS,CAAC,QAAQ,SAAI,OAAO,CAAC,GAAG,YAAS,CAAC,CAAC;QAC3D,CAAC,CAAC;QAEF,gDAAgD;QAChD,MAAM,CAAC,gDAAU,CAAC,QAAQ,CACxB,IAAI,CAAC,GAAG,CAAC,UAAC,GAAG;YACX,MAAM,CAAC,KAAI,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,GAAG,CAAC;QACvD,CAAC,CAAC,EACF;YAAC,iBAAU;iBAAV,UAAU,EAAV,qBAAU,EAAV,IAAU;gBAAV,4BAAU;;YAAG,QAAC;gBACb,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,UAAC,GAAG;oBACtB,MAAM,CAAC,GAAG,YAAY,+EAAiB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI;gBACtD,CAAC,CAAC;gBACF,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,UAAC,GAAG;oBACzB,MAAM,CAAC,GAAG,YAAY,+EAAiB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;gBACvD,CAAC,CAAC;aACH,CAAC;QAPY,CAOZ,CAAC,CAAC,SAAS,CAAC,UAAC,IAAS;YACtB,EAAE,CAAC,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;gBACxB,KAAI,CAAC,UAAU,CAAC,kBAAkB,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;gBACjD,KAAI,CAAC,eAAe,EAAE,CAAC;gBACvB,KAAI,CAAC,cAAc,EAAE,CAAC,CAAC,iFAAiF;YAC1G,CAAC;YAAC,IAAI,EAAC;gBACL,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,gDAAgD;YACvE,CAAC;QACH,CAAC,CAAC;IACJ,CAAC;IAlMmB,kBAAQ,GAAM,kEAAM,CAAC,YAAY,cAAW,CAAC;IAFnD;QAAjB,yEAAS,CAAC,KAAK,CAAC;;0CAAU;IAPhB,SAAS;QAJrB,wEAAS,CAAC;YACT,QAAQ,EAAE,YAAY;WACG;SAC1B,CAAC;6EAgByC;YACrB,sFAAS;YACD,uEAAgB;YACvB,6EAAe;YACf,uEAAgB;YAChB,MAAe;OApBzB,SAAS,CA4MjB;IAAD,gBAAC;;AAAA;SA5MQ,SAAS,e","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ItemsPage } from './items';\nimport { CustomComponentsModule } from './../../components/components.module';\nimport { TranslateModule } from '@ngx-translate/core';\n\n@NgModule({\n  declarations: [\n    ItemsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ItemsPage),\n    TranslateModule.forChild(),\n    CustomComponentsModule,\n  ],\n})\nexport class ItemsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/items/items.module.ts","import { Component, OnInit, DoCheck, OnDestroy, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController, ToastController } from 'ionic-angular';\nimport { ProductsProvider } from './../../providers/products/products';\nimport { Product } from './../../models/product';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Subscription, Observable } from 'rxjs';\nimport { CONFIG } from '../../config/config.int';\nimport { HttpErrorResponse } from '@angular/common/http';\n\nexport interface ProductSelected extends Product{\n  selected: boolean;\n}\n\n@IonicPage()\n@Component({\n  selector: 'page-items',\n  templateUrl: 'items.html',\n})\nexport class ItemsPage implements OnInit{\n  \n  productsOfUser?: Array<Product> = [];\n  nameHeader: string = 'Your items';\n  checkBoxedsOpened: boolean = false;\n  arrayProductsToDelete: Array<ProductSelected> = [];\n  trashEmptyOrFull: string = 'ios-trash-outline';\n  @ViewChild(\"fab\") fab: any;\n  \n  private static readonly ENDPOINT = `${CONFIG.API_ENDPOINT}/products`;\n  \n  // productsInLocal: Array<Product> = [];\n  subscriptions = new Subscription();\n  \n  \n  constructor(public navCtrl: NavController, \n    public navParams: NavParams,\n    private productsProvider: ProductsProvider,\n    private alertCtrl: AlertController,\n    private translate: TranslateService,\n    private toastCtrl: ToastController) {\n    }\n    \n    ngOnInit(){      \n      // let subscription = this.productsProvider.productByUserChanges().subscribe((products: Array<Product>)=>{\n      //   this.productsOfUser = products;\n      // })\n      // this.subscriptions.add(subscription);\n      \n      \n      this.emptyEverything();\n      this.getAllProducts();\n    }\n    \n    getAllProducts(){\n      this.productsProvider.getProductsByUser().subscribe((products: Array<Product>)=>{        \n        this.productsOfUser = products;  \n        \n      },\n      (error)=>{\n        // PONER API ERRORS BIEN???\n        console.log(error);\n        \n      })\n    }\n    \n    \n    \n    emptyEverything(){\n      this.arrayProductsToDelete.forEach((product: ProductSelected)=>{\n        product.selected = false;\n      })\n      this.arrayProductsToDelete = [];\n      this.trashEmptyOrFull = 'ios-trash-outline';\n      this.checkBoxedsOpened = false;      \n    }\n    \n    closeFab(){\n      if (this.fab) {\n        console.log(this.fab);\n        this.fab.close();\n      }\n    }\n    \n    ionViewWillLeave(){\n      this.emptyEverything();\n      this.closeFab();\n    }\n    \n    fabOpenCheckboxes(){\n      \n      this.checkBoxedsOpened = !this.checkBoxedsOpened;\n      if (!this.checkBoxedsOpened) {\n        this.emptyEverything();\n      }\n      \n    }\n    \n    deleteProducts(){\n      if(this.arrayProductsToDelete.length === 0){\n        this.translator('HAVE_TO_SELECT_PRODUCT_FIRST', false);\n      }\n      else if (this.arrayProductsToDelete.length === 1) {                \n        this.translator(['DELETE_PRODUCT', 'ARE_YOU_SURE', 'DONE_BUTTON', 'CANCEL_BUTTON'], true);\n      } else if (this.arrayProductsToDelete.length > 1){  \n        \n        this.translator(['DELETE_PRODUCTS', 'ARE_YOU_SURE', 'DONE_BUTTON', 'CANCEL_BUTTON'], true);\n      } \n    }\n    \n    translator(messageToTranslate: Array<string> | string, withAlert: boolean, withNumberOfProductsDeleted?: boolean){\n      this.translate.get(messageToTranslate).subscribe((data)=>{                          \n        if (withAlert) {\n          this.showAlert(data);\n        } else{\n          this.showToast(data, withNumberOfProductsDeleted);\n        }\n      })\n    }\n    \n    showAlert(data){\n      var textToShow;\n      if(this.arrayProductsToDelete.length === 0){\n        textToShow = data.HAVE_TO_SELECT_PRODUCT_FIRST\n      }\n      else if (this.arrayProductsToDelete.length === 1) {\n        textToShow = data.DELETE_PRODUCT\n      } else{\n        textToShow = data.DELETE_PRODUCTS\n      }\n      this.alertCtrl.create({\n        title: textToShow,\n        message: data.ARE_YOU_SURE, \n        buttons: [\n          {\n            text: data.DONE_BUTTON,\n            handler: () =>{\n              this.deleteManyProducts();\n            }\n          },\n          {\n            text: data.CANCEL_BUTTON,\n            role: 'cancel',\n            handler: () => {\n              console.log('cancel');\n              \n            }\n          }\n        ]\n      }).present();\n    }\n    \n    showToast(data: string, withNumberOfProductsDeleted?: boolean){\n      var messageToShow;\n      if (withNumberOfProductsDeleted) {\n        messageToShow = `${this.arrayProductsToDelete.length} ${data}`\n      } else{\n        messageToShow = data;\n      }\n      this.toastCtrl.create({\n        message: messageToShow,\n        duration: 2000,\n        position: 'top',\n      }).present();\n    }\n    \n    selectProductWithCheckbox(product: ProductSelected){\n      product.selected = !product.selected;\n      \n      if (product.selected && this.arrayProductsToDelete.indexOf(product) == -1) {\n        this.arrayProductsToDelete.push(product);           \n      } else{\n        this.arrayProductsToDelete = this.arrayProductsToDelete.filter((elem: ProductSelected)=>{\n          return elem !== product;\n        })        \n      }   \n      // this.arrayProductsToDelete.length === 1 ? this.showNumberOfProductsToDelete = `Delete ${this.arrayProductsToDelete.length} product` : this.showNumberOfProductsToDelete = `Delete ${this.arrayProductsToDelete.length} products`;\n      this.paintTrash();   \n    }\n    \n    paintTrash(){\n      if (this.arrayProductsToDelete.length === 0) {\n        this.trashEmptyOrFull = 'ios-trash-outline';\n      } else{\n        this.trashEmptyOrFull = 'ios-trash';\n      }\n    }\n    \n    goToProduct(product: Product){\n      this.navCtrl.push('ProductDetailPage', product);\n    }\n    \n    // EN BACK PONER MIDDLEWARES DE SI ES EL MISMO USER ID???\n    // LLAMAR A ESTA FUNCION MULTIPLES VECES???\n    \n    deleteManyProducts(){\n      let errors = [];\n      let urls = [];\n      this.arrayProductsToDelete.forEach((product: Product)=>{\n        urls.push(`${ItemsPage.ENDPOINT}/${product._id}/delete`);\n      })\n      \n      // COMO AFECTARIA LOS ERRORES MULTIPLES AQUI????\n      return Observable.forkJoin(\n        urls.map((url)=>{\n          return this.productsProvider.deleteProductByUser(url)\n        }),\n        (...results)=>({\n          failed: results.map((res)=>{\n            return res instanceof HttpErrorResponse ? res : null\n          }),\n          succeeded: results.map((res)=>{\n            return res instanceof HttpErrorResponse ? null : res;\n          })\n        })).subscribe((data: any)=>{ // ESTE DATA QUE ES???\n          if (errors.length === 0) {\n            this.translator('PRODUCTS_DELETED', false, true);\n            this.emptyEverything();\n            this.getAllProducts(); // MEJOR HACER SUBJECT YA QUE ESTOY EN LOCAL Y ME AHORRO LA SEGUNDA LLAMADA??????\n          } else{\n            console.log(errors); // PROBAR ERRORES DE BACK MULTIPLES AL DELETE???\n          }\n        })\n      }\n    }\n    \n    \n    \n\n\n// WEBPACK FOOTER //\n// ./src/pages/items/items.ts"],"sourceRoot":""}